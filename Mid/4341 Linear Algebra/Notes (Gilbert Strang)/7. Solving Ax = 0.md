**Lecturer:** W. Gilbert Strang
**Context:** Computing the Nullspace, Pivot Variables, Free Variables, Special Solutions, and Reduced Row Echelon Form.

---

## 1. Overview: The Algorithm for $Ax=0$

The goal of this lecture is to define an algorithm to solve the homogeneous system $Ax=0$. We are looking for the **Nullspace** of matrix $A$.
*   **Input:** Rectangular matrix $A$ ($m$ rows, $n$ columns).
*   **Output:** A description of all vectors $x$ such that $Ax=0$.
*   **Method:** Elimination (which preserves the nullspace).

> [!INFO] Key Concept
> Row operations (Elimination) change the Column Space, but they **do not** change the Nullspace. The solution set to $Ax=0$ remains the same throughout the elimination process.

---

## 2. Elimination and Rank

We start with a specific example matrix $A$ to demonstrate the algorithm.

### The Example Matrix
$$
A = \begin{bmatrix}
1 & 2 & 2 & 2 \\
2 & 4 & 6 & 8 \\
3 & 6 & 8 & 10
\end{bmatrix}
$$
*Observation:*
*   Column 2 is a multiple of Column 1 ($C_2 = 2C_1$). They are dependent.
*   Row 3 = Row 1 + Row 2. Rows are dependent.

### Step 1: Forward Elimination to Echelon Form ($U$)

We perform standard row elimination to get zeros below the pivots.

1.  **Pivot at $A_{1,1}$ (Value = 1):**
    *   Subtract $2 \times R_1$ from $R_2$.
    *   Subtract $3 \times R_1$ from $R_3$.

$$
\rightarrow \begin{bmatrix}
1 & 2 & 2 & 2 \\
0 & 0 & 2 & 4 \\
0 & 0 & 2 & 4
\end{bmatrix}
$$

2.  **Next Pivot:**
    *   We look at $A_{2,2}$, but it is **0**. We cannot pivot there.
    *   We look below it ($A_{3,2}$), it is also **0**. We cannot exchange rows.
    *   **Action:** Move to the next column. The pivot is at $A_{2,3}$ (Value = 2).

3.  **Eliminate below Pivot $A_{2,3}$:**
    *   Subtract $1 \times R_2$ from $R_3$.

$$
U = \begin{bmatrix}
\mathbf{1} & 2 & 2 & 2 \\
0 & 0 & \mathbf{2} & 4 \\
0 & 0 & 0 & 0
\end{bmatrix}
$$

This is the **Upper Echelon Matrix ($U$)**.

### Rank ($r$)
The **Rank** of a matrix is the number of pivots.
*   In this example, **$r = 2$**.
*   There are 2 pivots.

---

## 3. Pivot Variables vs. Free Variables

Once we have $U$, we can classify the variables $x = [x_1, x_2, x_3, x_4]^T$.

### Pivot Columns & Variables
Columns containing pivots are **Pivot Columns**. The corresponding variables are **Pivot Variables**.
*   Pivot Columns: 1 and 3.
*   Pivot Variables: $x_1, x_3$.

### Free Columns & Variables
Columns *without* pivots are **Free Columns**. The corresponding variables are **Free Variables**.
*   Free Columns: 2 and 4.
*   Free Variables: $x_2, x_4$.

> [!TIP] The Count
> *   Total Variables: $n$ (number of columns)
> *   Pivot Variables: $r$ (rank)
> *   Free Variables: $n - r$

Why "Free"? We can assign **any** value to the free variables. The pivot variables are then determined by the equations.

---

## 4. Special Solutions

To find the nullspace, we find **Special Solutions** by setting free variables to specific "easy" numbers (usually 1s and 0s) and solving for the pivot variables via **Back Substitution**.

We want to solve $Ux = 0$:
1.  $x_1 + 2x_2 + 2x_3 + 2x_4 = 0$
2.  $2x_3 + 4x_4 = 0$

### Special Solution 1 ($s_1$)
Set free variables: **$x_2 = 1$**, **$x_4 = 0$**.

1.  **Solve for $x_3$ (from Eq 2):**
    $$2x_3 + 4(0) = 0 \implies x_3 = 0$$
2.  **Solve for $x_1$ (from Eq 1):**
    $$x_1 + 2(1) + 2(0) + 2(0) = 0 \implies x_1 = -2$$

$$
s_1 = \begin{bmatrix} -2 \\ 1 \\ 0 \\ 0 \end{bmatrix}
$$

### Special Solution 2 ($s_2$)
Set free variables: **$x_2 = 0$**, **$x_4 = 1$**.

1.  **Solve for $x_3$ (from Eq 2):**
    $$2x_3 + 4(1) = 0 \implies 2x_3 = -4 \implies x_3 = -2$$
2.  **Solve for $x_1$ (from Eq 1):**
    $$x_1 + 2(0) + 2(-2) + 2(1) = 0 \implies x_1 - 4 + 2 = 0 \implies x_1 = 2$$

$$
s_2 = \begin{bmatrix} 2 \\ 0 \\ -2 \\ 1 \end{bmatrix}
$$

### The General Solution
The nullspace is the set of all linear combinations of the special solutions.
There are $n-r$ special solutions.

$$
x_{nullspace} = c_1 s_1 + c_2 s_2 = c_1 \begin{bmatrix} -2 \\ 1 \\ 0 \\ 0 \end{bmatrix} + c_2 \begin{bmatrix} 2 \\ 0 \\ -2 \\ 1 \end{bmatrix}
$$

---

## 5. Reduced Row Echelon Form ($R$)

We can simplify $U$ further to make the solution obvious. This is the **Reduced Row Echelon Form (rref)**, denoted by $R$.

**Requirements for $R$:**
1.  Pivots must be **1**.
2.  Zeros must exist **above** and below pivots.

### Converting $U$ to $R$

Start with $U$:
$$
\begin{bmatrix}
1 & 2 & 2 & 2 \\
0 & 0 & 2 & 4 \\
0 & 0 & 0 & 0
\end{bmatrix}
$$

1.  **Eliminate Upwards:** Use the pivot in Row 2 to eliminate the 2 above it in Row 1.
    *   $R_1 = R_1 - R_2$
$$
\begin{bmatrix}
1 & 2 & 0 & -2 \\
0 & 0 & 2 & 4 \\
0 & 0 & 0 & 0
\end{bmatrix}
$$

2.  **Normalize Pivots:** Divide rows by their pivot value to make pivots equal to 1.
    *   Divide $R_2$ by 2.

$$
R = \begin{bmatrix}
\mathbf{1} & 2 & 0 & -2 \\
0 & 0 & \mathbf{1} & 2 \\
0 & 0 & 0 & 0
\end{bmatrix}
$$

> [!NOTE] MATLAB Command
> The command to calculate this is `rref(A)`.

---

## 6. The Nullspace Matrix ($N$)

The Reduced Row Echelon form allows us to see the solution immediately. By rearranging columns, we can visualize $R$ as block matrices containing the Identity matrix $I$ and a "Free" matrix $F$.

### Block Structure of $R$
If we group pivot columns together and free columns together (mentally):
$$
R = \begin{bmatrix} I & F \\ 0 & 0 \end{bmatrix}
$$
*   **$I$**: $r \times r$ Identity matrix (in the pivot columns).
*   **$F$**: $r \times (n-r)$ Free matrix (in the free columns).

In our example:
*   Pivot Cols (1, 3) form $I = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$
*   Free Cols (2, 4) form $F = \begin{bmatrix} 2 & -2 \\ 0 & 2 \end{bmatrix}$

### Constructing the Nullspace Matrix $N$
The columns of the Nullspace Matrix $N$ are the special solutions.
Solving $Rx=0$ leads to this elegant pattern:

$$
N = \begin{bmatrix} -F \\ I \end{bmatrix} \quad \text{or with row reordering to match variables} \quad \begin{bmatrix} -F_{row1} \\ I_{row1} \\ -F_{row2} \\ I_{row2} \dots \end{bmatrix}
$$

Specifically, if $x_{pivot} = -F x_{free}$, and we set $x_{free} = I$ (identity structure for the free variables), we get:

$$
\text{Nullspace Matrix } N = \begin{bmatrix} -2 & 2 \\ 1 & 0 \\ 0 & -2 \\ 0 & 1 \end{bmatrix}
$$

Compare $N$ to our special solutions $s_1$ and $s_2$. They are the same.
*   Notice the Identity matrix sitting in the rows corresponding to free variables (Rows 2 and 4).
*   Notice $-F$ sitting in the rows corresponding to pivot variables (Rows 1 and 3).

> [!ABSTRACT] Summary
> 1.  Eliminate $A$ to $U$.
> 2.  Identify Pivot variables ($r$) and Free variables ($n-r$).
> 3.  Eliminate $U$ to $R$ (Reduced Row Echelon Form).
> 4.  The Nullspace matrix $N$ contains the special solutions.
> 5.  The reduced form reveals $N$ directly via the pattern involving $-F$ and $I$.

---

## 7. Transpose Example (Briefly)

Strang briefly checks the transpose of the example matrix, $A^T$ ($4 \times 3$ matrix).
$$
A^T = \begin{bmatrix} 1 & 2 & 3 \\ 2 & 4 & 6 \\ 2 & 6 & 8 \\ 2 & 8 & 10 \end{bmatrix}
$$
*   The rank of $A^T$ is also **2**. ($r(A) = r(A^T)$).
*   It has 3 columns, rank is 2.
*   Free variables: $n - r = 3 - 2 = 1$.
*   There will be **one** special solution for $A^T x = 0$.